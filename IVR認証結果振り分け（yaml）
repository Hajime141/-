flow_steps:
  - id: "step_問い合わせ内容の確認"
    description: "カードローン審査結果に関する問い合わせ対応。現在の認証状態を確認し、追加認証（PINまたは口頭）への誘導、もしくは次フェーズへの遷移を行う。"
    instruction:
      - "まず、お客様の問い合わせ内容がカードローン審査結果であることを復唱確認する。"
      - "次に、shared_data_pool内の現在の認証状態（auth_status）を確認する。"
      - "Function `determine_next_auth_step` を呼び出し、shared_data_poolの情報に基づいて次の遷移先を判定する。"
      - "判定ロジック:"
      - "1. PIN認証が可能かつ未実施の場合 -> PIN認証案内へ"
      - "2. PIN認証不可かつ未実施の場合 -> 口頭認証へ"
      - "3. 既に口頭認証済の場合 -> スキップしてPh2へ"
    tools:
      - name: "determine_next_auth_step"
        arguments:
          current_auth_status: "shared_data_pool.auth_status"
          has_cash_card: "shared_data_pool.has_cash_card"
    operator:
      - "カードローンサービス審査結果についてのお問い合わせですね。"
      - "審査結果についてご案内できるかどうか、私の方でも状況を確認いたします。"
      - "追加のご本人さま確認としてキャッシュカードの暗証番号を確認させていただきます。"
    transitions:
      - next_step: "step_第2PIN_PIN認証案内"
        condition: "function_result.next_action == 'go_to_pin_auth'"
      - next_step: "step_口頭認証単独_生年月日・住所の確認"
        condition: "function_result.next_action == 'go_to_oral_auth'"
      - next_step: "step_Ph2"
        condition: "function_result.next_action == 'skip_to_ph2'"
